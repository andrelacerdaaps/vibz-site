generator client {
  provider      = "prisma-client-js"
  // Adicionei os alvos de compilação para garantir que rode no Linux da Hostinger
  binaryTargets = ["native", "debian-openssl-1.1.x", "debian-openssl-3.0.x", "linux-musl", "rhel-openssl-1.0.x"]
}

datasource db {
  provider = "mysql"
  // --- AQUI ESTÁ A MUDANÇA PARA TESTE ---
  // Em vez de ler do ambiente (env), coloquei o link direto que você me mandou.
  // IMPORTANTE: Depois do teste, volte para env("DATABASE_URL") por segurança.
  url      = "mysql://u757616691_admin:Vibz2026Mudei@localhost:3306/u757616691_vibz"
}

enum MidiaStatus {
  APPROVED
  PENDING
  REJECTED
}

model User {
  id              String    @id @default(uuid())
  nomeEmpresa     String
  email           String    @unique
  senha           String
  role            String    @default("CLIENTE")
  
  statusConta     String    @default("PENDENTE")
  
  emailVerificado Boolean   @default(false)
  codigoVerifica  String?

  validadePlano   DateTime?
  testeGratisUsado Boolean  @default(false)
  
  instagramId         String?
  instagramUser       String?
  accessToken         String?   @db.Text
  logoUrl             String?
  
  accessTokenMeta     String?   @db.Text
  instagramBusinessId String?
  
  planoAtivo        String?   @default("Gratuito")
  
  planoId           String?
  plano             Plano?    @relation(fields: [planoId], references: [id])
  
  midias            Midia[]
  pagamentos        Pagamento[]
  
  createdAt         DateTime  @default(now())
}

model Plano {
  id           String   @id @default(uuid())
  nome         String
  preco        Float
  tipoCobranca String
  liberaVideo  Boolean  @default(false)
  liberaLayout Boolean  @default(false)
  usuarios     User[]
  createdAt    DateTime @default(now())
}

model Cupom {
  id        String   @id @default(uuid())
  codigo    String   @unique
  desconto  Float
  tipo      String
  ativo     Boolean  @default(true)
  createdAt DateTime @default(now())
}

model Midia {
  id        String      @id @default(uuid())
  url       String      @db.Text
  tipo      String
  duracao   Int         @default(10)

  autor     String?
  avatar    String?

  dataPost  DateTime    @default(now())
  expiresAt DateTime

  status    MidiaStatus @default(APPROVED)

  userId    String
  user      User        @relation(fields: [userId], references: [id])

  createdAt DateTime    @default(now())
}

model PreUser {
  id          String   @id @default(uuid())
  email       String   @unique
  nomeEmpresa String
  senha       String
  codigo      String
  createdAt   DateTime @default(now())
}

model Pagamento {
  id               String   @id @default(uuid())
  idTransacaoMP    String   @unique 
  valor            Float
  status           String   @default("pending") 
  metodo           String   @default("pix")
  
  userId           String
  user             User     @relation(fields: [userId], references: [id])
  
  planoId          String?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}